/******************************************************************************
 * JavaScript Document
 * iSrchObj v2.0
 * http://www.amonsoft.cn/code/iSrchObj/
 * Copyright (c) 2008 Amonsoft.cn
 ******************************************************************************/
function iSrchObj(){var THIS = this;var NAME = 'iSrchObj';var HOST = 'http://www.amonsoft.cn/';var PATH = HOST + 'code/' + NAME + '/';THIS.senm = new Array();THIS.selg = new Array();THIS.sept = new Array();THIS.sedi = '0';var sDiv;var _msb;var sObj;var eObj;var uTxt;var mDiv;var _msw;var _msh;var xPos;var yPos;var isdb = false;var isme = false;var _rng;var TPLT = '<tr><th width="20">{2}</th><td align="left"><a href="#" onclick="return iso.C({0})">{1}</a></td></tr>';THIS.init = function(){_msb = navigator.appName.indexOf("icrosoft") > 0;if (_msb){$D().onmousedown = ssObj;$D().ondblclick = dbClk;$D().onmouseup = seObj;}else{$W().onmousedown = ssObj;$W().ondblclick = dbClk;$W().onmouseup = seObj;}sDiv = $D().createElement('div');sDiv.innerHTML = S();$D().body.insertBefore(sDiv, $D().body.firstChild);sDiv = $X(NAME);mDiv = $X(NAME + '_MENU');THIS.addSearchEngine('页面搜索', '', '');};THIS.addSearchEngine = function(name, logo, uri){THIS.senm.push(name);THIS.selg.push(logo);THIS.sept.push(uri);};THIS.setDefaultSearchEngine = function(se){THIS.sedi = se;};function dbClk(evt){isdb = true;}function ssObj(evt){evt = E(evt);if (evt){sObj = (evt.target) ? evt.target : evt.srcElement;}}function seObj(evt){evt = E(evt);if (evt){if (evt.target){eObj = evt.target;uTxt = $W().getSelection().toString();}else{eObj = evt.srcElement;uTxt = $D().selection.createRange().text;}}var tag = eObj.tagName.toUpperCase();if(!isdb && eObj == sObj && tag != 'A' && tag != 'INPUT'){vSrch(uTxt, evt);}isdb = false;}function vSrch(str,evt){if(str.length < 1 || str.indexOf('\n') >= 0 || str.length > 64){sDiv.style.display = 'none';mDiv.style.display = 'none';return;}if(_msb){xPos = $D().documentElement.scrollTop + evt.y - 30;yPos = $D().documentElement.scrollLeft + evt.x + 5;}else{xPos = $D().body.scrollTop + evt.pageY - 30;yPos = $D().body.scrollLeft + evt.pageX + 5;}sDiv.style.top = xPos + 'px';sDiv.style.left = yPos + 'px';sDiv.style.display = '';}THIS.dSrch = function(){var se = _gc(NAME);if (se == '0'){dFind();return;}$W().open(THIS.sept[se].replace('{0}', uTxt), NAME);return false;};THIS.dHome = function(){$W().open(PATH);return false;};function dFind(){if($W().find){var b = $W().find(uTxt, false, false, true);if(!b){alert('页面搜索完毕！');}return;}if(!_rng){_rng = $D().body.createTextRange();}if(_rng.findText(uTxt)){_rng.scrollIntoView();_rng.select();_rng.collapse(false);}else{alert('页面搜索完毕！');}}THIS.mbo = function(){if(isme){mbx();return false;}_msw = 0;_msh = 0;mDiv.innerHTML = '';mDiv.style.display = '';mDiv.style.width = '0px';mDiv.style.height = '1px';mDiv.style.top = (xPos + 22) + 'px';mDiv.style.left = (yPos + 30) + 'px';mtw();isme = true;return false;};function mbx(){mDiv.style.display = 'none';isme = false;}THIS.mdo = function(){mDiv.style.display = '';isme = true;};THIS.mdx = function(){mDiv.style.display = 'none';isme = false;};function mtw(){if(_msw >= 140){mth();return ;}_msw += 10;mDiv.style.width = _msw + 'px';$W().setTimeout(mtw, 1);}function mth(){if(_msh >= 150){mtc();return ;}_msh += 6;mDiv.style.height = _msh + 'px';$W().setTimeout(mth, 1);}function mtc(){var innerHTML = '<table width="100%" border="0" cellpadding="1" cellspacing="0">';var i = 0;var g;var u = _gc(NAME);while(i< THIS.senm.length){g = i == u ? '&oplus;' : '&nbsp;';innerHTML += TPLT.replace('{0}', i).replace('{1}', THIS.senm[i]).replace('{2}', g);i += 1;}innerHTML += '</table>';mDiv.innerHTML = innerHTML;}function $(obj){return (typeof(obj) == '') ? $D().getElementById(obj) : obj;}function E(evt){return evt ? evt : $W().event;}function O(evt){return (evt.target) ? evt.target : evt.srcElement;}function S(){var sdiv = '<div id="'+ NAME + '" style="position:absolute;z-index:998;width:160px;height:28px;background-image:url(\'' + PATH + 'i/back.gif\');display:none;">';sdiv += '<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border: #FFFFFF solid 1px;">';sdiv += '<tr>';sdiv += '<td width="6" height="26"></td>';sdiv += '<td width="20" height="26" align="center"><input id="ib_Logo" type="image" src="' + PATH + 'i/logo.png" onclick="return iso.dHome()" style="border:0px" alt="LOGO" title="访问作者网站" /></td>';sdiv += '<td width="28" height="26" align="center"><input id="ib_Srch" type="image" src="' + PATH + 'i/srch.gif" onclick="return iso.mbo()" style="border:0px" alt="引擎" title="选择搜索引擎" /></td>';sdiv += '<td width="62" height="26" align="left"><label id="lb_Name">Amon搜索</label></td>';sdiv += '<td width="44" height="26" align="center"><input id="ib_Butn" type="image" src="' + PATH + 'i/butn.gif" onclick="return iso.dSrch()" style="border:0px" alt="搜索" title="搜索当前文字" /></td>';sdiv += '</tr>';sdiv += '</table>';sdiv += '</div>';sdiv += '<div id="' + NAME + '_MENU" style="display:none;overflow: hidden;border-width: 2px;border-style:solid;border-color:#51789b;position: absolute;z-index:999;float: left;top: 1px;left: 1px;height: 1px;width: 1px;background-color: #999999;" onmouseover="iso.mdo()" onmouseout="iso.mdx()"></div>';return sdiv;}THIS.C = function(i){_sc(NAME, i, 30);mDiv.style.display = 'none';return false;};function _gc(n){var s = $D().cookie.indexOf(n + '=');if ((!s) && (n != $D().cookie.substring(0, n.length))){return THIS.sedi;}if (s < 0){return THIS.sedi;}var l = s + n.length + 1;var e = $D().cookie.indexOf(';', l);if(e < 0){e = $D().cookie.length;}return unescape($D().cookie.substring(l, e));}function _sc(n, v, x, p, d, s){var td = new Date();td.setTime(td.getTime());if(x){x = x * 86400000;}var ed = new Date(td.getTime() + (x));$D().cookie = n + '=' + escape(v) + ((x) ? ';expires=' + ed.toGMTString() : '') + ((p) ? ';path=' + p : '') + ((d) ? ';domain=' + d : '') + ((s) ? ';secure' : '');}function _dc(n, p, d){if(_gc(n)){$D().cookie = n + '=' + ((p) ? ';path=' + p : '') + ((d) ? ';domain=' + d : '') + ';expires=Thu, 01-Jan-1970 00:00:01 GMT';}}function $D(){return document;}function $W(){return window;}function $X(obj){return $D().getElementById(obj);}THIS.init();}if(!iso) var iso = new iSrchObj();